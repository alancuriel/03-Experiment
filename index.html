<script src="https://d3js.org/d3.v4.min.js"></script>

<style></style>

<body>
    <main id="mainContent" style="
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100%;
    ">


        <div class="viz" id="viz1" style="transform: translateX(100vw);
                   display: flex;
                   flex-direction: column-reverse;
                   justify-content: center;
                   align-items: center;">
            <form name="viz-1" netlify>
                <p>
                </p>
                <p>
                    <label>Answer <input type="email" name="email" /></label>
                </p>
                <p>
                    <button type="submit">Send</button>
                </p>
            </form>
        </div>
        <div class="viz" id="viz2" style="transform: translateX(100vw);
                   display: flex;
                   flex-direction: column-reverse;
                   justify-content: center;
                   align-items: center;">
            <form name="viz-2" netlify>
                <p>
                </p>
                <p>
                    <label>Answer <input type="email" name="email" /></label>
                </p>
                <p>
                    <button type="submit">Send</button>
                </p>
            </form>
        </div>
        <div class="viz" id="viz3" style="transform: translateX(100vw);
                   display: flex;
                   flex-direction: column-reverse;
                   justify-content: center;
                   align-items: center;">
            <form name="viz-3" netlify>
                <p>

                </p>
                <p>
                    <label>Answer <input type="email" name="email" /></label>
                </p>
                <p>
                    <button type="submit">Send</button>
                </p>
            </form>
        </div>


    </main>
</body>

<script>
    const elements = d3.selectAll(".viz");

    const width = 500;
    const height = 500;



    /*  PUT CODE HERE */

    const svg1 = d3.create("svg")
        .attr("width", width)
        .attr("height", height)
        .style("background", "blue");

    const svg2 = d3.create("svg")
        .attr("width", width)
        .attr("height", height)
        .style("background", "red");


    const svg3 = d3.create("svg")
        .attr("width", width)
        .attr("height", height)
        .style("background", "green");



    /* ^ PUT CODE HERE ^ */

    d3.select("#viz1")
        .append(() => svg1.node());
    d3.select("#viz2")
        .insert(() => svg2.node());
    d3.select("#viz3")
        .insert(() => svg3.node());

    let previousRandom = Math.round(Math.random() * (elements.size() - 1));
    const randomsSelected = [previousRandom];


    const nextRandom = () => {
        if (randomsSelected.length < elements.size()) {
            let r = Math.round(Math.random() * (elements.size() - 1));
            while (randomsSelected.indexOf(r) > -1) {
                r = Math.round(Math.random() * (elements.size() - 1));
            }
            previousRandom = r;
            randomsSelected.push(r);
            return r;
        }
    };

    elements
        .style("transform", (d, i) => {
            return i === previousRandom ? "translate(0)" : "translateX(100vw)";
        })
        .style("position", "absolute")
        .style("transition", "ease-in-out transform 0.7s");

    elements.selectAll("form").on("submit", function(e, i, d) {
        d3.event.preventDefault();
        if (randomsSelected.length < elements.size()) {
            elements
                .filter(function(d, i) {
                    return i === previousRandom;
                })
                .style("transform", "translateX(-100vw)");

            let nextr = nextRandom();

            elements
                .filter(function(d, i) {
                    return i === nextr;
                })
                .style("transform", "translateX(0)");
        }
    });
</script>